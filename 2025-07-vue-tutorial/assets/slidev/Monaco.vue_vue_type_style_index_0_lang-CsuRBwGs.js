const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/slidev/CodeRunner-CWrB5F8c.js","assets/modules/vue-Bl2l7_5U.js","assets/monaco/bundled-types-Cyvq5-7x.js","assets/modules/shiki-CxsFbBJl.js","assets/modules/shiki-UqVAgQbi.css","assets/modules/file-saver-C8QSpN-3.js","assets/monaco/bundled-types-wYURhAAQ.css","assets/index-0rbkrWEB.js","assets/index-DK-nEx8-.css","assets/slidev/context-BAQLIszF.js","assets/slidev/IconButton.vue_vue_type_script_setup_true_lang-DSQlQH8j.js","assets/CodeRunner-DcJPFc8h.css"])))=>i.map(i=>d[i]);
import{_ as h,a0 as R}from"../monaco/bundled-types-Cyvq5-7x.js";import{f as T,r,aO as P,X as F,p as v,o as M,e as K,g as S,k as U,b as X,a1 as w,j as Y,$ as q,z as B}from"../modules/vue-Bl2l7_5U.js";import{l as E}from"../lz-string-si4yBCUE.js";import{a as G,B as L}from"../index-0rbkrWEB.js";import{u as J}from"./context-BAQLIszF.js";const Q={class:"relative slidev-monaco-container"},re=T({__name:"Monaco",props:{codeLz:{default:""},diffLz:{},lang:{default:"typescript"},readonly:{type:Boolean,default:!1},lineNumbers:{default:"off"},height:{default:"initial"},editorOptions:{},ata:{type:Boolean,default:!0},runnable:{type:Boolean,default:!1},writable:{},autorun:{type:[Boolean,String],default:!0},showOutputAt:{type:[null,Boolean,String,Number,Array]},outputHeight:{},highlightOutput:{type:Boolean,default:!0},runnerOptions:{}},setup(V){const e=V,x=q(()=>h(()=>import("./CodeRunner-CWrB5F8c.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])).then(i=>i.default)),s=r(E.decompressFromBase64(e.codeLz).trimEnd()),y=e.diffLz&&r(E.decompressFromBase64(e.diffLz).trimEnd()),N=B(()=>e.writable&&!e.readonly&&!1),c={ts:"typescript",js:"javascript"}[e.lang]??e.lang,C={typescript:"mts",javascript:"mjs",ts:"mts",js:"mjs"}[e.lang]??e.lang,k=r(),p=r(),f=r(0),m=r(),D=B(()=>e.height==="auto"?`${f.value}px`:e.height==="initial"?`${m.value}px`:e.height),_=r(),{$page:H,$renderContext:$}=J(),{currentSlideNo:A}=G(),W=P(()=>Math.abs(H.value-A.value)<=1&&_.value,i=>{["slide","presenter"].includes($.value)?i():setTimeout(i,5e3)});return F(async()=>{const{default:i}=await h(async()=>{const{default:t}=await import("../monaco/bundled-types-Cyvq5-7x.js").then(a=>a.ae);return{default:t}},__vite__mapDeps([2,3,1,4,5,6])),{ata:l,monaco:o,editorOptions:j}=await i(),u=o.editor.createModel(s.value,c,o.Uri.parse(`file:///${L()}.${C}`));u.onDidChangeContent(()=>s.value=u.getValue());const b={automaticLayout:!0,readOnly:e.readonly,lineNumbers:e.lineNumbers,minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:10,bottom:10},lineNumbersMinChars:3,bracketPairColorization:{enabled:!1},tabSize:2,fontSize:11.5,fontFamily:"var(--slidev-code-font-family)",scrollBeyondLastLine:!1,useInlineViewWhenSpaceIsLimited:!1,...j,...e.editorOptions};let n;if(y){const t=o.editor.createModel(y.value,c,o.Uri.parse(`file:///${L()}.${C}`));t.onDidChangeContent(()=>s.value=u.getValue());const a=o.editor.createDiffEditor(p.value,{renderOverviewRuler:!1,...b});a.setModel({original:u,modified:t});const d=a.getOriginalEditor(),g=a.getModifiedEditor(),z=()=>{const O=Math.max(d.getContentHeight(),g.getContentHeight())+4;m.value??=O,f.value=O,v(()=>a.layout())};d.onDidContentSizeChange(z),g.onDidContentSizeChange(z),n=g}else{const t=o.editor.create(p.value,{model:u,lineDecorationsWidth:0,...b});t.onDidContentSizeChange(a=>{const d=a.contentHeight+4;m.value??=d,f.value=d,v(()=>n.layout())}),n=t}_.value=()=>{W(),h(()=>import("../monaco/bundled-types-Cyvq5-7x.js").then(t=>t.af),__vite__mapDeps([2,3,1,4,5,6])),e.ata&&(l(n.getValue()),n.onDidChangeModelContent(R(1e3,()=>{l(n.getValue())})))};const I=n.layoutContentWidget.bind(n);n.layoutContentWidget=t=>{I(t),t.getId()==="editor.contrib.resizableContentHoverWidget"&&(t._resizableNode.domNode.style.transform=t._positionPreference===1?"translateY(calc(100% * (var(--slidev-slide-scale) - 1)))":"")},n.addAction({id:"slidev-save",label:"Save",keybindings:[o.KeyMod.CtrlCmd|o.KeyCode.KeyS],run:()=>{N.value,console.warn("[Slidev] this monaco editor is not writable, save action is ignored.")}}),v(()=>o.editor.remeasureFonts()),setTimeout(()=>o.editor.remeasureFonts(),1e3)}),(i,l)=>(M(),K("div",Q,[S("div",{ref_key:"outer",ref:k,class:"relative slidev-monaco-container-inner",style:U({height:D.value})},[S("div",{ref_key:"container",ref:p,class:"absolute inset-0.5"},null,512)],4),e.runnable?(M(),X(w(x),{key:0,modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=o=>s.value=o),lang:w(c),autorun:e.autorun,"show-output-at":e.showOutputAt,height:e.outputHeight,"highlight-output":e.highlightOutput,"runner-options":e.runnerOptions},null,8,["modelValue","lang","autorun","show-output-at","height","highlight-output","runner-options"])):Y("v-if",!0)]))}});export{re as _};
